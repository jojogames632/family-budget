{% extends 'base.html.twig' %}

{% block title %}Graphiques{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/header.css') }}" />
	<link rel="stylesheet" href="{{ asset('css/graphic.css') }}" />
{% endblock %}

{% block body %}
    <header class="bg-dark">
		<nav class="row m-0">
			<a class="col-1" href="{{ path('home') }}">
				<img src="../images/family-budget-logo.png" alt="logo" />
			</a>
			{# Desktop nav #}
			<div class="col-10 align-items-center desktopNav">
				<ul class="d-flex justify-content-between w-100">
					<li class="d-flex align-items-center">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill text-white" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                            <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
                        </svg>
                        <a href="{{ path('home') }}" class="text-decoration-none text-white fw-bold ms-2">Accueil</a>
                    </li>
                    <li class="d-flex align-items-center">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tags-fill text-white" viewBox="0 0 16 16">
                            <path d="M2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2zm3.5 4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/>
                            <path d="M1.293 7.793A1 1 0 0 1 1 7.086V2a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l.043-.043-7.457-7.457z"/>
                        </svg>
                        <a href="{{ path('category') }}" class="text-decoration-none text-white fw-bold ms-2">Catégories</a>
                    </li>
					<li class="d-flex align-items-center">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-right text-white" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                        </svg>
						<a href="{{ path('transaction') }}" class="text-decoration-none text-white fw-bold ms-2">Transactions</a>
					</li>
					<li class="d-flex align-items-center">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-piggy-bank-fill text-white" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M7.964 1.527c-2.977 0-5.571 1.704-6.32 4.125h-.55A1 1 0 0 0 .11 6.824l.254 1.46a1.5 1.5 0 0 0 1.478 1.243h.263c.3.513.688.978 1.145 1.382l-.729 2.477a.5.5 0 0 0 .48.641h2a.5.5 0 0 0 .471-.332l.482-1.351c.635.173 1.31.267 2.011.267.707 0 1.388-.095 2.028-.272l.543 1.372a.5.5 0 0 0 .465.316h2a.5.5 0 0 0 .478-.645l-.761-2.506C13.81 9.895 14.5 8.559 14.5 7.069c0-.145-.007-.29-.02-.431.261-.11.508-.266.705-.444.315.306.815.306.815-.417 0 .223-.5.223-.461-.026a.95.95 0 0 0 .09-.255.7.7 0 0 0-.202-.645.58.58 0 0 0-.707-.098.735.735 0 0 0-.375.562c-.024.243.082.48.32.654a2.112 2.112 0 0 1-.259.153c-.534-2.664-3.284-4.595-6.442-4.595zm7.173 3.876a.565.565 0 0 1-.098.21.704.704 0 0 1-.044-.025c-.146-.09-.157-.175-.152-.223a.236.236 0 0 1 .117-.173c.049-.027.08-.021.113.012a.202.202 0 0 1 .064.199zm-8.999-.65A6.613 6.613 0 0 1 7.964 4.5c.666 0 1.303.097 1.893.273a.5.5 0 1 0 .286-.958A7.601 7.601 0 0 0 7.964 3.5c-.734 0-1.441.103-2.102.292a.5.5 0 1 0 .276.962zM5 6.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z"/>
                        </svg>
						<a href="{{ path('budget') }}" class="text-decoration-none text-white fw-bold ms-2">Budget</a>
					</li>
					<li class="d-flex align-items-center">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-line-fill text-info" viewBox="0 0 16 16">
                            <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2z"/>
                        </svg>
						<a href="{{ path('graphic') }}" class="text-decoration-none text-info fw-bold ms-2">Graphiques</a>
					</li>
				</ul>
			</div>
			{# Mobile nav #}
			<div class="col justify-content-end align-items-center burgerCol">
				<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-list text-info" id="burgerBtn" viewBox="0 0 16 16">
					<path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
				</svg>
				<div id="mobileNav" class="bg-dark">
					<div class="d-flex justify-content-end px-2">
						<span id="closeBtn" class="text-info fs-1 fw-bold">X</span>
					</div>
					<ul class="d-flex flex-column align-items-center justify-content-between mobileUl">
						<li class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill text-white" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                                <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
                            </svg>
							<a href="{{ path('home') }}" class="text-decoration-none text-white fw-bold ms-2">Accueil</a>
						</li>
						<li class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tags-fill text-white" viewBox="0 0 16 16">
                                <path d="M2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2zm3.5 4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/>
                                <path d="M1.293 7.793A1 1 0 0 1 1 7.086V2a1 1 0 0 0-1 1v4.586a1 1 0 0 0 .293.707l7 7a1 1 0 0 0 1.414 0l.043-.043-7.457-7.457z"/>
                            </svg>
							<a href="{{ path('category') }}" class="text-decoration-none text-white fw-bold ms-2">Catégories</a>
						</li>
						<li class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-right text-white" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                            </svg>
							<a href="{{ path('transaction') }}" class="text-decoration-none text-white fw-bold ms-2">Transactions</a>
						</li>
						<li class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-piggy-bank-fill text-white" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M7.964 1.527c-2.977 0-5.571 1.704-6.32 4.125h-.55A1 1 0 0 0 .11 6.824l.254 1.46a1.5 1.5 0 0 0 1.478 1.243h.263c.3.513.688.978 1.145 1.382l-.729 2.477a.5.5 0 0 0 .48.641h2a.5.5 0 0 0 .471-.332l.482-1.351c.635.173 1.31.267 2.011.267.707 0 1.388-.095 2.028-.272l.543 1.372a.5.5 0 0 0 .465.316h2a.5.5 0 0 0 .478-.645l-.761-2.506C13.81 9.895 14.5 8.559 14.5 7.069c0-.145-.007-.29-.02-.431.261-.11.508-.266.705-.444.315.306.815.306.815-.417 0 .223-.5.223-.461-.026a.95.95 0 0 0 .09-.255.7.7 0 0 0-.202-.645.58.58 0 0 0-.707-.098.735.735 0 0 0-.375.562c-.024.243.082.48.32.654a2.112 2.112 0 0 1-.259.153c-.534-2.664-3.284-4.595-6.442-4.595zm7.173 3.876a.565.565 0 0 1-.098.21.704.704 0 0 1-.044-.025c-.146-.09-.157-.175-.152-.223a.236.236 0 0 1 .117-.173c.049-.027.08-.021.113.012a.202.202 0 0 1 .064.199zm-8.999-.65A6.613 6.613 0 0 1 7.964 4.5c.666 0 1.303.097 1.893.273a.5.5 0 1 0 .286-.958A7.601 7.601 0 0 0 7.964 3.5c-.734 0-1.441.103-2.102.292a.5.5 0 1 0 .276.962zM5 6.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0z"/>
                            </svg>
							<a href="{{ path('budget') }}" class="text-decoration-none text-white fw-bold ms-2">Budget</a>
						</li>
						<li class="d-flex align-items-center">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart-line-fill text-info" viewBox="0 0 16 16">
                                <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2z"/>
                            </svg>
							<a href="{{ path('graphic') }}" class="text-decoration-none text-info fw-bold ms-2">Graphiques</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
    <main>
		<div class="d-flex justify-content-center mt-4">
			<select id="accountSelect" name="accountSelect">
				{% for account in accounts %}
					<option value="{{ account.id }}" {{ accountId == account.id ? 'selected' : null }}>{{ account.name }}</option>
				{% endfor %}
			</select>
		</div>

		<section id="graphicSection" class="mt-4">
			<canvas id="batonCanvas" width="100" height="100"></canvas>
		</section>
		
		<div class="row row-cols-1 row-cols-lg-4" id="firstPieRow">
			{# incomes #}
			<p class="text-center text-primary"></p>
			<div class="col mt-4">
				<p class="text-center text-info"></p>
				<canvas id="pieCanvas" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas2" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas3" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas4" width="400" height="400"></canvas>
			</div>
		</div>
		<div class="row row-cols-1 row-cols-lg-4">
			{# Spent #}
			<div class="col mt-4">
				<canvas id="pieCanvas5" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas6" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas7" width="400" height="400"></canvas>
			</div>
			<div class="col mt-4">
				<canvas id="pieCanvas8" width="400" height="400"></canvas>
			</div>
		</div>
    </main>
{% endblock %}

{% block javascripts %}
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.1/chart.min.js" integrity="sha512-O2fWHvFel3xjQSi9FyzKXWLTvnom+lOYR/AUEThL/fbP4hv1Lo5LCFCGuTXBRyKC4K4DJldg5kxptkgXAzUpvA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="{{ asset('js/header.js') }}"></script>
	<script src="{{ asset('js/graphic.js') }}"></script>
	<script>
		const batonCanvas = document.getElementById('batonCanvas').getContext('2d');
		const batonDiagram = new Chart(batonCanvas, {
			data: {
				labels: {{ labels|raw }},
				datasets: [{
					type: 'bar',
					label: 'Revenus',
					data: {{ incomes|raw }},
					backgroundColor: 'lightGreen',
					borderColor: 'black',
					borderWidth: 1
				},
				{
					type: 'bar',
					label: 'Dépenses',
					data: {{ spentAmounts|raw }},
					backgroundColor: 'crimson',
					borderColor: 'black',
					borderWidth: 1
				},
				{
					type: 'line',
					label: 'Solde',
					data: {{ balances|raw }},
					backgroundColor: 'white',
					borderColor: 'white',
					borderWidth: 1,
				}]
			}
		})

		const pieCanvas = document.getElementById('pieCanvas').getContext('2d');
		const pieDiagram = new Chart(pieCanvas, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }}
				}],
			}
		})

		const pieCanvas2 = document.getElementById('pieCanvas2').getContext('2d');
		const pieDiagram2 = new Chart(pieCanvas2, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas3 = document.getElementById('pieCanvas3').getContext('2d');
		const pieDiagram3 = new Chart(pieCanvas3, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas4 = document.getElementById('pieCanvas4').getContext('2d');
		const pieDiagram4 = new Chart(pieCanvas4, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas5 = document.getElementById('pieCanvas5').getContext('2d');
		const pieDiagram5 = new Chart(pieCanvas5, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas6 = document.getElementById('pieCanvas6').getContext('2d');
		const pieDiagram6 = new Chart(pieCanvas6, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas7 = document.getElementById('pieCanvas7').getContext('2d');
		const pieDiagram7 = new Chart(pieCanvas7, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

		const pieCanvas8 = document.getElementById('pieCanvas8').getContext('2d');
		const pieDiagram8 = new Chart(pieCanvas8, {
			type: 'pie',
			data: {
				labels: {{ fullTypeLabels|raw }},
				datasets: [{
					data: {{ fullTypeMovements|raw }},
					backgroundColor: {{ fullTypeColors|raw }},
					borderColor: 'black',
					borderWidth: 1 
				}],
			}
		})

	</script>
{% endblock %}